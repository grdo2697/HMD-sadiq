<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ุนุฑุถ ุงูุนููุจุงุช</title>
  <style>
    body { font-family: 'Tahoma', sans-serif; background: #f2f2f2; padding: 20px; text-align: center; }
    table { width: 100%; border-collapse: collapse; background: #fff; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; font-size: 14px; }
    th { background: #444; color: white; }
    .controls { margin: 20px 0; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
    .controls input, .controls select, .controls button { padding: 8px; font-size: 14px; border-radius: 5px; border: 1px solid #ccc; }
    .total-box { margin-top: 20px; font-size: 18px; font-weight: bold; background: #dff0d8; padding: 10px; border-radius: 10px; display: inline-block; }
    .primary { background: #007bff; color: white; cursor: pointer; }
    .primary:hover { background: #0056b3; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <h2>ุนุฑุถ ุงูุนููุจุงุช</h2>

  <div class="controls">
    <input type="text" id="search" placeholder="ุจุญุซ ุจุงูุงุณู ุฃู ุงูุณุจุจ" oninput="renderTable()">
    <select id="filterType" onchange="renderTable()">
      <option value="">ูู ุงูุฃููุงุน</option>
      <option value="ุฎุตู">ุฎุตู</option>
      <option value="ุชูุจูู">ุชูุจูู</option>
    </select>
    <select id="filterManager" onchange="renderTable()">
      <option value="">ูู ุงููุฏูุฑูู</option>
      <option value="ุฃุญูุฏ">ุฃุญูุฏ</option>
      <option value="ุณุนูุฏ">ุณุนูุฏ</option>
    </select>
    <button onclick="clearFilters()">ูุณุญ ุงููู</button>
    <button class="primary" onclick="exportToExcel()">๐ฅ ุชุตุฏูุฑ ุฅูู Excel</button>
  </div>

  <table id="penaltyTable">
    <thead>
      <tr>
        <th>ุงูุงุณู</th>
        <th>ุงููุณู</th>
        <th>ููุน ุงูุนููุจุฉ</th>
        <th>ุงูุชุงุฑูุฎ</th>
        <th>ุณุจุจ ุงูุนููุจุฉ</th>
        <th>ุงููุฏูุฑ</th>
        <th>ููุงุญุธุฉ ุงูุบุฑุงูุฉ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="total-box" id="totalBox">ุงููุฌููุน: 0</div>

  <script>
    const allData = [
      { ุงุณู_ุงูููุธู: "ุนูู", ุงููุณู: "ุงููุจูุนุงุช", ููุน_ุงูุนููุจุฉ: "ุฎุตู", ุงูุชุงุฑูุฎ: "2025-04-20", ุณุจุจ_ุงูุนููุจุฉ: "ุชุฃุฎูุฑ", ุงููุฏูุฑ: "ุฃุญูุฏ", ููุงุญุธุฉ_ุงูุบุฑุงูุฉ: "10000" },
      { ุงุณู_ุงูููุธู: "ุณุงุฑุฉ", ุงููุณู: "ุงูุฏุนู", ููุน_ุงูุนููุจุฉ: "ุชูุจูู", ุงูุชุงุฑูุฎ: "2025-04-18", ุณุจุจ_ุงูุนููุจุฉ: "ุงุณุชุฎุฏุงู ุงููุงุชู", ุงููุฏูุฑ: "ุณุนูุฏ", ููุงุญุธุฉ_ุงูุบุฑุงูุฉ: "0" },
      { ุงุณู_ุงูููุธู: "ุญุณูู", ุงููุณู: "ุงููุจูุนุงุช", ููุน_ุงูุนููุจุฉ: "ุฎุตู", ุงูุชุงุฑูุฎ: "2025-04-19", ุณุจุจ_ุงูุนููุจุฉ: "ุบูุงุจ", ุงููุฏูุฑ: "ุฃุญูุฏ", ููุงุญุธุฉ_ุงูุบุฑุงูุฉ: "5000" },
    ];

    const tableBody = document.querySelector("#penaltyTable tbody");
    const searchInput = document.getElementById("search");
    const filterType = document.getElementById("filterType");
    const filterManager = document.getElementById("filterManager");
    const totalValueEl = document.getElementById("totalBox");

    function renderTable() {
      tableBody.innerHTML = "";
      let total = 0;
      const search = searchInput.value.toLowerCase();
      const type = filterType.value;
      const manager = filterManager.value;

      const filtered = allData.filter(item => {
        const matchSearch = item.ุงุณู_ุงูููุธู.toLowerCase().includes(search) || item.ุณุจุจ_ุงูุนููุจุฉ.toLowerCase().includes(search);
        const matchType = !type || item.ููุน_ุงูุนููุจุฉ === type;
        const matchManager = !manager || item.ุงููุฏูุฑ === manager;
        return matchSearch && matchType && matchManager;
      });

      filtered.forEach(item => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.ุงุณู_ุงูููุธู}</td>
          <td>${item.ุงููุณู}</td>
          <td>${item.ููุน_ุงูุนููุจุฉ}</td>
          <td>${item.ุชุงุฑูุฎ}</td>
          <td>${item.ุณุจุจ_ุงูุนููุจุฉ}</td>
          <td>${item.ูุฏูุฑ}</td>
          <td>${item.ููุงุญุธุฉ_ุงูุบุฑุงูุฉ}</td>
        `;
        tableBody.appendChild(row);
        const amount = parseInt(item.ููุงุญุธุฉ_ุงูุบุฑุงูุฉ.replace(/[^\d]/g, '')) || 0;
        total += amount;
      });

      totalValueEl.textContent = `ุงููุฌููุน: ${total.toLocaleString()} ุฏููุงุฑ`;
    }

    function clearFilters() {
      searchInput.value = "";
      filterType.value = "";
      filterManager.value = "";
      renderTable();
    }

    function exportToExcel() {
      const exportData = allData
        .filter(i => i.ููุงุญุธุฉ_ุงูุบุฑุงูุฉ && !i.ููุงุญุธุฉ_ุงูุบุฑุงูุฉ.includes("ุงููุฌููุน"))
        .map(i => ({
          "ุงูุงุณู": i.ุงุณู_ุงูููุธู,
          "ุงููุณู": i.ุงููุณู,
          "ููุน ุงูุนููุจุฉ": i.ููุน_ุงูุนููุจุฉ,
          "ุงูุชุงุฑูุฎ": i.ุชุงุฑูุฎ,
          "ุณุจุจ ุงูุนููุจุฉ": i.ุณุจุจ_ุงูุนููุจุฉ,
          "ุงููุฏูุฑ": i.ูุฏูุฑ,
          "ููุงุญุธุฉ ุงูุบุฑุงูุฉ": i.ููุงุญุธุฉ_ุงูุบุฑุงูุฉ,
        }));

      exportData.push({
        "ุงูุงุณู": "",
        "ุงููุณู": "",
        "ููุน ุงูุนููุจุฉ": "",
        "ุงูุชุงุฑูุฎ": "",
        "ุณุจุจ ุงูุนููุจุฉ": "",
        "ุงููุฏูุฑ": "ุงููุฌููุน",
        "ููุงุญุธุฉ ุงูุบุฑุงูุฉ": totalValueEl.textContent.replace("ุงููุฌููุน: ", "")
      });

      const ws = XLSX.utils.json_to_sheet(exportData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "ุนููุจุงุช");
      XLSX.writeFile(wb, "ุนููุจุงุช_ุงูููุธููู.xlsx");
    }

    renderTable();
  </script>
</body>
</html>
