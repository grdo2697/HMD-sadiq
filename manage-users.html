<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600&display=swap" rel="stylesheet>
  <style>
    /* Ù†ÙØ³ Ø£Ù†Ù…Ø§Ø· index.html Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø·ÙÙŠÙØ© */
    :root {
      --primary: #0ea5e9;
      --danger: #e74c3c;
      --success: #2ecc71;
    }

    .user-form {
      background: rgba(255,255,255,0.9);
      padding: 1.5rem;
      border-radius: 15px;
      margin-bottom: 2rem;
    }

    .permissions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <script>
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    if (!currentUser || currentUser.username !== "hr") {
      alert("ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„!");
      window.location.href = "login.html";
    }
  </script>

  <button class="logout-btn" onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  
  <div class="container">
    <h1>ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h1>
    
    <div class="user-form">
      <h3>â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
      <input type="text" id="newUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
      <input type="password" id="newPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      
      <div class="permissions-grid">
        <label><input type="checkbox" id="perm1"> Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</label>
        <label><input type="checkbox" id="perm2"> Ø§Ù„ØªØµØ¯ÙŠØ±</label>
        <label><input type="checkbox" id="perm3"> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</label>
      </div>
      
      <button onclick="addUser()">Ø­ÙØ¸</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
          <th>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</th>
          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody id="usersList"></tbody>
    </table>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem("users")) || [];
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    function renderUsers() {
      const tbody = document.getElementById("usersList");
      tbody.innerHTML = "";
      
      users.forEach((user, index) => {
        const row = `
          <tr>
            <td>${user.username}</td>
            <td>${user.permissions.join("ØŒ ")}</td>
            <td>
              <button onclick="editUser(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
              <button onclick="deleteUser(${index})" style="background: var(--danger)">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </td>
          </tr>
        `;
        tbody.innerHTML += row;
      });
    }

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
    function addUser() {
      const newUser = {
        username: document.getElementById("newUsername").value,
        password: document.getElementById("newPassword").value,
        permissions: []
      };

      if (document.getElementById("perm1").checked) newUser.permissions.push("Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      if (document.getElementById("perm2").checked) newUser.permissions.push("Ø§Ù„ØªØµØ¯ÙŠØ±");
      if (document.getElementById("perm3").checked) newUser.permissions.push("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†");

      users.push(newUser);
      localStorage.setItem("users", JSON.stringify(users));
      renderUsers();
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function editUser(index) {
      const user = users[index];
      document.getElementById("newUsername").value = user.username;
      document.getElementById("newPassword").value = user.password;
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
      document.getElementById("perm1").checked = user.permissions.includes("Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      document.getElementById("perm2").checked = user.permissions.includes("Ø§Ù„ØªØµØ¯ÙŠØ±");
      document.getElementById("perm3").checked = user.permissions.includes("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†");
      
      users.splice(index, 1);
      localStorage.setItem("users", JSON.stringify(users));
      renderUsers();
    }

    // Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function deleteUser(index) {
      const deletedUser = users[index];
      
      if (deletedUser.username === currentUser.username) {
        logout();
      }
      
      users.splice(index, 1);
      localStorage.setItem("users", JSON.stringify(users));
      renderUsers();
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    function logout() {
      localStorage.removeItem("currentUser");
      window.location.href = "login.html";
    }

    // Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
    renderUsers();
  </script>
</body>
</html>
